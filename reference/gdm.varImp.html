<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quantify Model Significance and Variable Importance in a Fitted
Generalized Dissimilarity Model Using Matrix Permutation. — gdm.varImp • gdm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quantify Model Significance and Variable Importance in a Fitted
Generalized Dissimilarity Model Using Matrix Permutation. — gdm.varImp" />
<meta property="og:description" content="This function uses matrix permutation to perform model and
variable significance testing and to estimate variable importance in a
generalized dissimilarity model. The function can be run in parallel on
multicore machines to reduce computation time." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantify Model Significance and Variable Importance in a Fitted
Generalized Dissimilarity Model Using Matrix Permutation.</h1>
    
    <div class="hidden name"><code>gdm.varImp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses matrix permutation to perform model and
variable significance testing and to estimate variable importance in a
generalized dissimilarity model. The function can be run in parallel on
multicore machines to reduce computation time.</p>
    </div>

    <pre class="usage"><span class='fu'>gdm.varImp</span><span class='op'>(</span><span class='va'>spTable</span>, <span class='va'>geo</span>, splines <span class='op'>=</span> <span class='cn'>NULL</span>, knots <span class='op'>=</span> <span class='cn'>NULL</span>,
fullModelOnly <span class='op'>=</span> <span class='cn'>FALSE</span>, nPerm <span class='op'>=</span> <span class='fl'>50</span>, parallel <span class='op'>=</span> <span class='cn'>FALSE</span>, cores <span class='op'>=</span> <span class='fl'>2</span>,
sampleSites <span class='op'>=</span> <span class='fl'>1</span>, sampleSitePairs <span class='op'>=</span> <span class='fl'>1</span>, outFile <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spTable</th>
      <td><p>A site-pair table, same as used to fit a <code><a href='gdm.html'>gdm</a></code>.</p></td>
    </tr>
    <tr>
      <th>geo</th>
      <td><p>Similar to the <code><a href='gdm.html'>gdm</a></code> geo argument. The only
difference is that the geo argument does not have a default in this function.</p></td>
    </tr>
    <tr>
      <th>splines</th>
      <td><p>Same as the <code><a href='gdm.html'>gdm</a></code> splines argument.</p></td>
    </tr>
    <tr>
      <th>knots</th>
      <td><p>Same as the <code><a href='gdm.html'>gdm</a></code> knots argument.</p></td>
    </tr>
    <tr>
      <th>fullModelOnly</th>
      <td><p>Set to TRUE to test only the full variable set. Set to
FALSE to estimate model significance and variable importance and significance
using matrix permutation and backward elimination. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>nPerm</th>
      <td><p>Number of permutations to use to estimate p-values. Default is 50.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Whether or not to run the matrix permutations and model
fitting in parallel. Parallel processing is highly recommended when either
(i) the nPerms argument is large (&gt;100) or (ii) a large number of site-pairs
(and or variables) are being used in model fitting (note computation demand
can be reduced using subsampling - see next arguments). The default is FALSE.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>When the parallel argument is set to TRUE, the number of cores
to be registered for parallel processing. Must be &lt;= the number of cores in
the machine running the function.</p></td>
    </tr>
    <tr>
      <th>sampleSites</th>
      <td><p>The fraction (0-1, though a value of 0 would be silly,
wouldn't it?) of <em>sites to retain</em> from the full site-pair table. If
less than 1, this argument will completely remove a fraction of sites such
that they are not used in the permutation routines.</p></td>
    </tr>
    <tr>
      <th>sampleSitePairs</th>
      <td><p>The fraction (0-1) of <em>site-pairs (i.e., rows)
to retain</em> from the full site-pair table - in other words, all sites will
be used in the permutation routines (assuming sampleSites = 1), but not
all <em>site-pair combinations</em>. In the case where both the sampleSites
and the sampleSitePairs argument have values less than 1, sites first will
be removed using the sampleSites argument, followed by removal of site-pairs
using the sampleSitePairs argument. Note that the number of site-pairs
removed is based on the fraction of the resulting site-pair table after
sites have been removed, not on the size of the full site-pair table.</p></td>
    </tr>
    <tr>
      <th>outFile</th>
      <td><p>An optional character string to write the object returned by
the function to disk as an .RData object (".RData"" is not required as part
of the file name). The .RData object will contain a single list with the
name of "outObject". The default is NULL, meaning that no file will be written.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of four tables. The first table summarizes full model deviance,
percent deviance explained by the full model, the p-value of the full model,
and the number of permutations used to calculate the statistics for each
fitted model (i.e., the full model and each model with variables removed in
succession during the backward elimination procedure if fullModelOnly=F). The
remaining three tables summarize (1) variable importance, (2) variable
significance, and (3) the number of permutations used to calculate the
statistics for that model, which is provided because some GDMs may fail
to fit for some permutations / variable combinations and you might want to
know how many permutations were used when calculating statistics. Or maybe you
don't, you decide.</p>
<p>Variable importance is measured as the percent change in deviance explained
by the full model and the deviance explained by a model fit with that variable
permuted. Significance is estimated using the bootstrapped p-value when the
variable has been permuted. For most cases, the number of permutations will
equal the nPerm argument. However, the value may be less should any of the
permutations fail to fit.</p>
<p>If fullModelOnly=T, the tables will have values only in the first column and
NAs elsewhere.</p>
<p>NOTE: In some cases, GDM may fail to fit if there is a weak relationship
between the response and predictors (e.g., when an important variable is
removed). Such cases are indicated by -9999 values in the variable importance,
variable significance, and number of permutations tables.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To test model significance, first a "full model" is fit using
un-permuted environmental data. Next, the environmental data are permuted
nPerm times (by randomizing the order of the rows) and a GDM is fit to each
permuted table. Model significance is determined by comparing the deviance
explained by GDM fit to the un-permuted table to the distribution of deviance
explained values from GDM fit to the nPerm permuted tables. To assess variable
significance, this process is repeated for each predictor individually (i.e.,
only the data for the variable being tested is permuted rather than the entire
environmental table). Variable importance is quantified as the percent change
in deviance explained between a model fit with and without that variable
(technically speaking, with the variable permuted and un-permuted). If
fullModelOnly=FALSE, this process continues by then permutating the site-pair
table nPerm times, but removing one variable at a time and reassessing
variable importance and significance. At each step, the least important
variable is dropped (backward elimination) and the process continues until
all non-significant predictors are removed.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ferrier S, Manion G, Elith J, Richardson, K (2007) Using
generalized dissimilarity modelling to analyse and predict patterns of
beta diversity in regional biodiversity assessment. <em>Diversity &amp;
Distributions</em> 13, 252-264.</p>
<p>Fitzpatrick, MC, Sanders NJ, Ferrier S, Longino JT, Weiser MD, and RR Dunn.
2011. Forecasting the Future of Biodiversity: a Test of Single- and
Multi-Species Models for Ants in North America. <em>Ecography</em> 34: 836-47.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Karel Mokany and Matt Fitzpatrick</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'>##fit table environmental data</span></span>
<span class='r-in'><span class='co'>##set up site-pair table using the southwest data set</span></span>
<span class='r-in'><span class='va'>sppData</span> <span class='op'>&lt;-</span> <span class='va'>southwest</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>13</span>,<span class='fl'>14</span><span class='op'>)</span><span class='op'>]</span></span>
<span class='r-in'><span class='va'>envTab</span> <span class='op'>&lt;-</span> <span class='va'>southwest</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>southwest</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span></span>
<span class='r-in'><span class='va'>sitePairTab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='formatsitepair.html'>formatsitepair</a></span><span class='op'>(</span><span class='va'>sppData</span>, <span class='fl'>2</span>, XColumn<span class='op'>=</span><span class='st'>"Long"</span>, YColumn<span class='op'>=</span><span class='st'>"Lat"</span>,</span>
<span class='r-in'>sppColumn<span class='op'>=</span><span class='st'>"species"</span>, siteColumn<span class='op'>=</span><span class='st'>"site"</span>, predData<span class='op'>=</span><span class='va'>envTab</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>No abundance column was specified, so the species data are</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>                 assumed to be presences.</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Aggregation function missing: defaulting to length</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Site weighting type: Equal"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Site-pair table created with 4371 rows (94 unique sites) and 26 columns (10 environmental variables)."</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## not run</span></span>
<span class='r-in'><span class='co'>#modTest &lt;- gdm.varImp(sitePairTab, geo=T, nPerm=50, parallel=T, cores=10)</span></span>
<span class='r-in'><span class='co'>#barplot(sort(modTest[[2]][,1], decreasing=T))</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matt Fitzpatrick, Karel Mokany, Glenn Manion, Diego Nieto-Lugilde, Simon Ferrier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


